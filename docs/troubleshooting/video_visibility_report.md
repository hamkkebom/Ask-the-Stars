# 비디오 미표출 원인 분석 및 해결 방안

## 1. 개요
현재 `https://www.hamkkebom.com/videos` 페이지에서 동영상이 보이지 않는 문제는 **데이터베이스(DB)와 스토리지(R2) 간의 동기화 상태 불일치**가 주된 원인으로 분석됩니다. 프론트엔드는 DB에 저장된 메타데이터를 기반으로 영상을 렌더링하지만, 실제 영상 파일이 스토리지에 있더라도 DB에 해당 기록이 없으면 화면에 표시되지 않습니다.

## 2. 상세 원인 분석

### A. 데이터 흐름 구조
1. **프론트엔드 (`/videos`)**: 백엔드 API (`GET /videos`)를 호출하여 `status: 'FINAL'`인 비디오 목록을 요청합니다.
2. **백엔드 (`VideosController`)**: DB의 `Video`, `Project`, `TechnicalSpec` 테이블을 조회를 시도합니다.
3. **현재 상태**: 스토리지(R2)에는 영상 파일이 존재할 수 있으나, 이를 가리키는 DB 레코드가 생성되어 있지 않아 빈 리스트(`[]`)가 반환되고 있습니다.

### B. 주요 결핍 요소
*   **메타데이터 부재**: 파일명, 길이, 썸네일 경로 등 영상 정보를 담은 DB 레코드가 없습니다.
*   **동기화 로직 미실행**: `VideosService.syncWithStorage()` 메서드가 구현되어 있으나, 배포 후 이 기능이 실행되지 않았습니다.
*   **소유자(User) 데이터 부재 가능성**: 동기화 로직은 비디오의 소유자를 할당하기 위해 최소 1명의 시스템 관리자(Admin) 또는 유저가 DB에 존재해야 합니다.

## 3. 해결 제안

### 단계 1: 데이터베이스 사용자 시딩 (필수)
비디오 프로젝트의 소유자를 지정하기 위해 관리자 계정이 필요합니다. DB에 사용자가 한 명도 없다면 동기화가 실패합니다.
*   이미 계정이 있다면 이 단계는 건너뜁니다.
*   없다면 SQL 시드 파일(`슈퍼베이스/db_seeds.sql`)을 실행하거나 회원가입을 통해 1명의 유저를 생성해야 합니다.

### 단계 2: R2-DB 동기화 실행
백엔드에 구현된 동기화 API를 호출하여 스토리지의 파일 정보를 DB로 가져옵니다.

**API 호출 방법 (cURL 또는 Postman):**
```bash
POST https://api.hamkkebom.com/videos/sync
# (실제 백엔드 도메인에 맞게 수정 필요, 개발 환경의 경우 http://localhost:3001/api/videos/sync)
```
*   이 작업은 R2 버킷의 모든 파일(`*.mp4`, `*.mov`)을 스캔하고, DB에 없는 파일에 대해 자동으로 `Project`와 `Video` 데이터를 생성합니다.
*   생성된 비디오는 자동으로 `FINAL` 상태가 되어 `/videos` 페이지에 즉시 노출됩니다.

### 단계 3: 주기적 동기화 자동화 (권장)
향후 영상 업로드 시마다 수동으로 Sync를 호출하는 번거로움을 없애기 위해 다음 중 하나를 적용합니다.
*   **관리자 페이지(Admin Dashboard)**에 '스토리지 동기화' 버튼 추가
*   **Cron Job**을 설정하여 매일 1회 자동 동기화

## 4. 실행 계획
1.  **DB 확인**: `User` 테이블에 데이터가 있는지 확인합니다.
2.  **Sync API 호출**: 로컬 또는 프로덕션 환경에서 `/videos/sync` 엔드포인트를 호출합니다.
3.  **확인**: `/videos` 페이지 새로고침하여 영상 노출 여부를 확인합니다.
